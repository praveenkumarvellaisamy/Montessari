CREATE PROCEDURE PRUSERINSERT  
(		
	@USERNAME				VARCHAR(100)
	,@EMAIL					NVARCHAR(100)
	,@PASSWORD				NVARCHAR(200)
	,@EMAILVERIFIEDYN		TINYINT
	,@MOBILENO				VARCHAR(20)
	,@MOBILENOVERIFIEDYN	TINYINT
	,@USERCODE				INT
)
AS
BEGIN
	DECLARE @USERID INT

	SELECT @USERID = MAX(FLDUSERID)
	FROM TBLUSER

	SELECT @USERID = ISNULL(@USERID,0) + 1

	INSERT INTO TBLUSER
	(
		FLDUSERID				
		,FLDUSERNAME			
		,FLDEMAIL				
		,FLDPASSWORD			
		,FLDEMAILVERIFIEDYN		
		,FLDMOBILENO			
		,FLDMOBILENOVERIFIEDYN	
		,FLDCREATEDDATE			
		,FLDCREATEDBY			
		,FLDMODIFIEDDATE		
		,FLDMODIFIEDBY			
	)
	SELECT @USERID
		,@USERNAME				
		,@EMAIL					
		,HASHBYTES('MD5', @PASSWORD)				
		,@EMAILVERIFIEDYN		
		,@MOBILENO				
		,@MOBILENOVERIFIEDYN	
		,GETUTCDATE()
		,@USERCODE
		,GETUTCDATE()
		,@USERCODE

	SELECT @USERID AS FLDUSERID
END